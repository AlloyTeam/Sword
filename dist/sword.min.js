/* Sword
 * By AlloyTeam http://www.alloyteam.com/
 * Github: https://github.com/AlloyTeam/Sword
 * MIT Licensed.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():"function"==typeof define&&define.cmd?define(function(t,r,n){n.exports=e()}):t.Sword=e()}(this,function(){function t(t,e,r,n,i,s){this.setValues(t,e,r,n,i,s)}t.DEG_TO_RAD=Math.PI/180,t.identity=null,t.prototype={setValues:function(t,e,r,n,i,s){return this.a=null==t?1:t,this.b=e||0,this.c=r||0,this.d=null==n?1:n,this.tx=i||0,this.ty=s||0,this},append:function(t,e,r,n,i,s){var o=this.a,a=this.b,u=this.c,h=this.d;return(1!=t||0!=e||0!=r||1!=n)&&(this.a=o*t+u*e,this.b=a*t+h*e,this.c=o*r+u*n,this.d=a*r+h*n),this.tx=o*i+u*s+this.tx,this.ty=a*i+h*s+this.ty,this},appendTransform:function(e,r,n,i,s,o,a,u,h){if(s%360)var c=s*t.DEG_TO_RAD,p=Math.cos(c),l=Math.sin(c);else p=1,l=0;return o||a?(o*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,r),this.append(p*n,l*n,-l*i,p*i,0,0)):this.append(p*n,l*n,-l*i,p*i,e,r),(u||h)&&(this.tx-=u*this.a+h*this.c,this.ty-=u*this.b+h*this.d),this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},copy:function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},clone:function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)},toString:function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"}},t.identity=new t;var e=function(t,r,n){var i=function(t,r,n){t.$observer||(t.$observer=this);var i=t.$observer,s=[];e.isArray(t)&&(0===t.length&&(t.$observeProps={},t.$observeProps.$observerPath="#"),i.mock(t));for(var o in t)t.hasOwnProperty(o)&&(n?e.isArray(r)&&e.isInArray(r,o)?(s.push(o),i.watch(t,o)):e.isString(r)&&o==r&&(s.push(o),i.watch(t,o)):(s.push(o),i.watch(t,o)));i.target=t,i.propertyChangedHandler||(i.propertyChangedHandler=[]);var a=n?n:r;i.propertyChangedHandler.push({all:!n,propChanged:a,eventPropArr:s})};return i.prototype={onPropertyChanged:function(t,r,n,i,s){if(r!==n&&this.propertyChangedHandler)for(var o=e._getRootName(t,s),a=0,u=this.propertyChangedHandler.length;u>a;a++){var h=this.propertyChangedHandler[a];(h.all||e.isInArray(h.eventPropArr,o)||0===o.indexOf("Array-"))&&h.propChanged.call(this.target,t,r,n,s)}0!==t.indexOf("Array-")&&"object"==typeof r&&this.watch(i,t,i.$observeProps.$observerPath)},mock:function(t){var r=this;e.methods.forEach(function(n){t[n]=function(){var t=Array.prototype.slice.call(this,0),i=Array.prototype[n].apply(this,Array.prototype.slice.call(arguments));if(new RegExp("\\b"+n+"\\b").test(e.triggerStr)){for(var s in this)this.hasOwnProperty(s)&&!e.isFunction(this[s])&&r.watch(this,s,this.$observeProps.$observerPath);r.onPropertyChanged("Array-"+n,this,t,this,this.$observeProps.$observerPath)}return i}})},watch:function(t,r,n){if("$observeProps"!==r&&"$observer"!==r&&!e.isFunction(t[r])){t.$observeProps||(t.$observeProps={}),t.$observeProps.$observerPath=void 0!==n?n:"#";var i=this,s=t.$observeProps[r]=t[r];if(Object.defineProperty(t,r,{get:function(){return this.$observeProps[r]},set:function(e){var n=this.$observeProps[r];this.$observeProps[r]=e,i.onPropertyChanged(r,e,n,this,t.$observeProps.$observerPath)}}),"object"==typeof s){e.isArray(s)&&(this.mock(s),0===s.length&&(s.$observeProps||(s.$observeProps={}),s.$observeProps.$observerPath=void 0!==n?n:"#"));for(var o in s)s.hasOwnProperty(o)&&this.watch(s,o,t.$observeProps.$observerPath+"-"+r)}}}},new i(t,r,n)};e.methods=["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","unshift","toLocaleString","toString","size"],e.triggerStr=["concat","pop","push","reverse","shift","sort","splice","unshift","size"].join(","),e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.isString=function(t){return"string"==typeof t},e.isInArray=function(t,e){for(var r=t.length;--r>-1;)if(e===t[r])return!0;return!1},e.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},e.twoWay=function(t,r,n,i){"object"==typeof t[r]&&"object"==typeof n[i]?(e(t,r,function(t,e){n[i]=this[r]}),e(n,i,function(e,n){t[r]=this[i]})):(e(t,r,function(t,e){n[i]=e}),e(n,i,function(e,n){t[r]=n}))},e._getRootName=function(t,e){return"#"===e?t:e.split("-")[1]},e.add=function(t,e,r){t[e]=r;var n=t.$observer;n.watch(t,e)},Array.prototype.size=function(t){this.length=t};var r="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xlink",i=function(s,o){if(o){"string"==typeof s&&(s=i(s));for(var a in o)o.hasOwnProperty(a)&&("xlink:"==a.substring(0,6)?s.setAttributeNS(n,a.substring(6),String(o[a])):s.setAttribute(a,String(o[a])))}else s=document.createElementNS("http://www.w3.org/2000/svg",s),s.style&&(s.style.webkitTapHighlightColor="rgba(0,0,0,0)"),s.opacity=s.scaleX=s.scaleY=1,s.left=s.top=s.rotation=s.skewX=s.skewY=s.originX=s.originY=0,s.matrix=t.identity,e(s,["left","top","scaleX","scaleY","rotation","skewX","skewY","originX","originY"],function(){this.matrix.identity().appendTransform(this.left,this.top,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY,this.originX,this.originY),i(s,{transform:"matrix("+this.matrix.a+","+this.matrix.b+","+this.matrix.c+","+this.matrix.d+","+this.matrix.tx+","+this.matrix.ty+")"})}),e(s,["opacity"],function(){s.setAttribute("opacity",this.opacity)}),s.attr=function(t,e){if(1===arguments.length)return"string"==typeof t?-1!==t.indexOf(":")?this.getAttributeNS(r,t):this.getAttribute(t):i(this,t);var n={};return n[t]=e,i(this,n)};return s},s=function(t,e,n){this.parent="string"==typeof t?document.querySelector(t):t,this.svg=document.createElementNS(r,"svg"),this.svg.setAttribute("style","border: 1px solid black;overflow: hidden;"),this.svg.setAttribute("width",e),this.svg.setAttribute("height",n),this.svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.parent.appendChild(this.svg)};s.prototype={line:function(t,e,r,n,s){var o=i("line",{x1:t,y1:e,x2:r,y2:n});return this.svg.appendChild(o),o},rect:function(t,e){var r=i("rect",{width:t,height:e});return this.svg.appendChild(r),r},text:function(t,e){var r=i("text");return r.style.font=e,r.textContent=t,this.svg.appendChild(r),r},circle:function(t){var e=i("circle",{r:t});return this.svg.appendChild(e),e},path:function(t){var e=i("path",{d:t});return e.to=s.pathTo,this.svg.appendChild(e),e},ellipse:function(t,e){var r=i("ellipse",{rx:t,ry:e});return this.svg.appendChild(r),r},image:function(t){if("string"==typeof t){var e=i("image",{"xlink:href":t}),r=new Image;r.onload=function(){e.attr({width:r.width,height:r.height}),r=null},r.src=t}else var e=i("image",{"xlink:href":t,width:t.width,height:t.height});return this.svg.appendChild(e),e},group:function(){var t=i("g");this.svg.appendChild(t);for(var e=0,r=arguments.length;r>e;e++)t.appendChild(arguments[e]);return t.add=function(e){t.appendChild(e)},t.remove=function(e){t.removeChild(e)},t},remove:function(t){this.svg.removeChild(t)}};var o=function(t,e,r){return new s(t,e,r)};return function(){function t(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return t.push(t.splice(r,1)[0])}function e(e,r,n){function i(){var s=Array.prototype.slice.call(arguments,0),o=s.join("␀"),a=i.cache=i.cache||{},u=i.count=i.count||[];return a.hasOwnProperty(o)?(t(u,o),n?n(a[o]):a[o]):(u.length>=1e3&&delete a[u.shift()],u.push(o),a[o]=e.apply(r,s),n?n(a[o]):a[o])}return i}function r(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t.hasOwnProperty(n)&&(e[n]=r(t[n]));return e}function n(t,e,r){var n=this,i=Date.now(),s=d(n.attr("d"),t),o=s[1];fromD=s[0],diffD=[];for(var a=0,u=fromD.length;u>a;a++){diffD[a]=[0];for(var h=1,c=fromD[a].length;c>h;h++)diffD[a][h]=(o[a][h]-fromD[a][h])/e}var p=function(t,e,r,n){var s=Date.now()-i,o=s/r;if(o>1)o=1,t.attr("d",e);else{for(var a=[],u=0,h=fromD.length;h>u;u++){a[u]=[fromD[u][0]];for(var c=1,l=fromD[u].length;l>c;c++)a[u][c]=+fromD[u][c]+o*r*diffD[u][c];a[u]=a[u].join(" ")}a=a.join(" "),t.attr("d",a)}1!==o&&requestAnimFrame(function(){p(t,e,r,n)})};p(n,t,e,r)}var i=function(){return this.join(",").replace(/,?([achlmqrstvxz]),?/gi,"$1")},o=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,a=function(t){var e=r(t);return e.toString=i,e},u=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,h=function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=String.prototype.toUpperCase,p=function(t){if(!t)return null;var e=f(t);if(e.arr)return a(e.arr);var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},n=[];return h(t)&&h(t[0])&&(n=a(t)),n.length||String(t).replace(o,function(t,e,i){var s=[],o=e.toLowerCase();if(i.replace(u,function(t,e){e&&s.push(+e)}),"m"==o&&s.length>2&&(n.push([e].concat(s.splice(0,2))),o="l",e="m"==e?"l":"L"),"r"==o)n.push([e].concat(s));else for(;s.length>=r[o]&&(n.push([e].concat(s.splice(0,r[o]))),r[o]););}),n.toString=i,e.arr=a(n),n},l=function(t){var e=f(t);if(e.abs)return a(e.abs);if(h(t)&&h(t&&t[0])||(t=p(t)),!t||!t.length)return[["M",0,0]];var r=[],n=0,s=0,o=0,u=0,l=0;"M"==t[0][0]&&(n=+t[0][1],s=+t[0][2],o=n,u=s,l++,r[0]=["M",n,s]);for(var g,d,y=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),v=l,x=t.length;x>v;v++){if(r.push(g=[]),d=t[v],d[0]!=c.call(d[0]))switch(g[0]=c.call(d[0]),g[0]){case"A":g[1]=d[1],g[2]=d[2],g[3]=d[3],g[4]=d[4],g[5]=d[5],g[6]=+(d[6]+n),g[7]=+(d[7]+s);break;case"V":g[1]=+d[1]+s;break;case"H":g[1]=+d[1]+n;break;case"R":for(var b=[n,s].concat(d.slice(1)),m=2,w=b.length;w>m;m++)b[m]=+b[m]+n,b[++m]=+b[m]+s;r.pop(),r=r.concat(catmullRom2bezier(b,y));break;case"M":o=+d[1]+n,u=+d[2]+s;default:for(m=1,w=d.length;w>m;m++)g[m]=+d[m]+(m%2?n:s)}else if("R"==d[0])b=[n,s].concat(d.slice(1)),r.pop(),r=r.concat(catmullRom2bezier(b,y)),g=["R"].concat(d.slice(-2));else for(var C=0,A=d.length;A>C;C++)g[C]=d[C];switch(g[0]){case"Z":n=o,s=u;break;case"H":n=g[1];break;case"V":s=g[1];break;case"M":o=g[g.length-2],u=g[g.length-1];default:n=g[g.length-2],s=g[g.length-1]}}return r.toString=i,e.abs=a(r),r},f=function(t){var e=f.ps=f.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var r in e)e.hasOwnProperty(r)&&r!=t&&(e[r].sleep--,!e[r].sleep&&delete e[r])}),e[t]},g=function(t,e,r,n){return[t,e,r,n,r,n]},d=e(function(t,e){var r=!e&&f(t);if(!e&&r.curve)return a(r.curve);for(var n=l(t),i=e&&l(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=(function(t,e,r){var n,i,s={T:1,Q:1};if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in s)&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(a2c[apply](0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==r||"S"==r?(n=2*e.x-e.bx,i=2*e.y-e.by):(n=e.x,i=e.y),t=["C",n,i].concat(t.slice(1));break;case"T":"Q"==r||"T"==r?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(q2c(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(q2c(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(g(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(g(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(g(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(g(e.x,e.y,e.X,e.Y))}return t}),h=function(t,e){if(t[e].length>7){t[e].shift();for(var r=t[e];r.length;)p[e]="A",i&&(d[e]="A"),t.splice(e++,0,["C"].concat(r.splice(0,6)));t.splice(e,1),b=Math.max(n.length,i&&i.length||0)}},c=function(t,e,r,s,o){t&&e&&"M"==t[o][0]&&"M"!=e[o][0]&&(e.splice(o,0,["M",s.x,s.y]),r.bx=0,r.by=0,r.x=t[o][1],r.y=t[o][2],b=Math.max(n.length,i&&i.length||0))},p=[],d=[],y="",v="",x=0,b=Math.max(n.length,i&&i.length||0);b>x;x++){n[x]&&(y=n[x][0]),"C"!=y&&(p[x]=y,x&&(v=p[x-1])),n[x]=u(n[x],s,v),"A"!=p[x]&&"C"==y&&(p[x]="C"),h(n,x),i&&(i[x]&&(y=i[x][0]),"C"!=y&&(d[x]=y,x&&(v=d[x-1])),i[x]=u(i[x],o,v),"A"!=d[x]&&"C"==y&&(d[x]="C"),h(i,x)),c(n,i,s,o,x),c(i,n,o,s,x);var m=n[x],w=i&&i[x],C=m.length,A=i&&w.length;s.x=m[C-2],s.y=m[C-1],s.bx=parseFloat(m[C-4])||s.x,s.by=parseFloat(m[C-3])||s.y,o.bx=i&&(parseFloat(w[A-4])||o.x),o.by=i&&(parseFloat(w[A-3])||o.y),o.x=i&&w[A-2],o.y=i&&w[A-1]}return i||(r.curve=a(n)),i?[n,i]:n},null,a);window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),s.pathTo=n}(),o});