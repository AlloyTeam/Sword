{"version":3,"file":"sving.esm.js","sources":["../src/matrix2d.js","../src/obaa.js","../src/sving.js"],"sourcesContent":["﻿\nfunction Matrix2D(a, b, c, d, tx, ty) {\n  this.setValues(a, b, c, d, tx, ty)\n}\n\nMatrix2D.DEG_TO_RAD = Math.PI / 180\n\n\nMatrix2D.identity = null // set at bottom of class definition.\nMatrix2D.prototype = {\n  setValues: function (a, b, c, d, tx, ty) {\n    // don't forget to update docs in the constructor if these change:\n    this.a = (a == null) ? 1 : a\n    this.b = b || 0\n    this.c = c || 0\n    this.d = (d == null) ? 1 : d\n    this.tx = tx || 0\n    this.ty = ty || 0\n    return this\n  },\n\n  append: function (a, b, c, d, tx, ty) {\n    var a1 = this.a\n    var b1 = this.b\n    var c1 = this.c\n    var d1 = this.d\n    if (a != 1 || b != 0 || c != 0 || d != 1) {\n      this.a = a1 * a + c1 * b\n      this.b = b1 * a + d1 * b\n      this.c = a1 * c + c1 * d\n      this.d = b1 * c + d1 * d\n    }\n    this.tx = a1 * tx + c1 * ty + this.tx\n    this.ty = b1 * tx + d1 * ty + this.ty\n    return this\n  },\n\n  appendTransform: function (x, y, scaleX, scaleY, rotation, skewX, skewY, regX, regY) {\n    if (rotation % 360) {\n      var r = rotation * Matrix2D.DEG_TO_RAD\n      var cos = Math.cos(r)\n      var sin = Math.sin(r)\n    } else {\n      cos = 1\n      sin = 0\n    }\n\n    if (skewX || skewY) {\n      // TODO: can this be combined into a single append operation?\n      skewX *= Matrix2D.DEG_TO_RAD\n      skewY *= Matrix2D.DEG_TO_RAD\n      this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y)\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0)\n    } else {\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y)\n    }\n\n    if (regX || regY) {\n      this.tx -= regX * this.a + regY * this.c\n      this.ty -= regX * this.b + regY * this.d\n    }\n    return this\n  },\n\n  identity: function () {\n    this.a = this.d = 1\n    this.b = this.c = this.tx = this.ty = 0\n    return this\n  },\n\n  copy: function (matrix) {\n    return this.setValues(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty)\n  },\n\n  clone: function () {\n    return new Matrix2D(this.a, this.b, this.c, this.d, this.tx, this.ty)\n  },\n\n  toString: function () {\n    return \"[Matrix2D (a=\" + this.a + \" b=\" + this.b + \" c=\" + this.c + \" d=\" + this.d + \" tx=\" + this.tx + \" ty=\" + this.ty + \")]\"\n  }\n}\n\n\nMatrix2D.identity = new Matrix2D()\n\n\nexport default Matrix2D\n","﻿/*\n * obaa 2.1.0\n * By dntzhang\n * Github: https://github.com/Tencent/omi/tree/master/packages/obaa\n * MIT Licensed.\n */\n\n\n// __r_: root\n// __c_: prop change callback\n// __p_: path\n\nfunction obaa(target, arr, callback) {\n\n  var eventPropArr = []\n  if (isArray(target)) {\n    if (target.length === 0) {\n      target.__o_ = {\n        __r_: target,\n        __p_: '#'\n      }\n    }\n    mock(target, target)\n  }\n  if (target && typeof target === 'object' && Object.keys(target).length === 0) {\n    track(target)\n    target.__o_.__r_ = target\n  }\n  for (var prop in target) {\n    if (target.hasOwnProperty(prop)) {\n      if (callback) {\n        if (isArray(arr) && isInArray(arr, prop)) {\n          eventPropArr.push(prop)\n          watch(target, prop, null, target)\n        } else if (isString(arr) && prop == arr) {\n          eventPropArr.push(prop)\n          watch(target, prop, null, target)\n        }\n      } else {\n        eventPropArr.push(prop)\n        watch(target, prop, null, target)\n      }\n    }\n  }\n  if (!target.__c_) {\n    target.__c_ = []\n  }\n  var propChanged = callback ? callback : arr\n  target.__c_.push({\n    all: !callback,\n    propChanged: propChanged,\n    eventPropArr: eventPropArr\n  })\n}\n\nvar triggerStr = [\n  'concat',\n  'copyWithin',\n  'fill',\n  'pop',\n  'push',\n  'reverse',\n  'shift',\n  'sort',\n  'splice',\n  'unshift',\n  'size'\n].join(',')\n\nvar methods = [\n  'concat',\n  'copyWithin',\n  'entries',\n  'every',\n  'fill',\n  'filter',\n  'find',\n  'findIndex',\n  'forEach',\n  'includes',\n  'indexOf',\n  'join',\n  'keys',\n  'lastIndexOf',\n  'map',\n  'pop',\n  'push',\n  'reduce',\n  'reduceRight',\n  'reverse',\n  'shift',\n  'slice',\n  'some',\n  'sort',\n  'splice',\n  'toLocaleString',\n  'toString',\n  'unshift',\n  'values',\n  'size'\n]\n\nfunction mock(target, root) {\n  methods.forEach(function (item) {\n    target[item] = function () {\n      var old = Array.prototype.slice.call(this, 0)\n      var result = Array.prototype[item].apply(\n        this,\n        Array.prototype.slice.call(arguments)\n      )\n      if (new RegExp('\\\\b' + item + '\\\\b').test(triggerStr)) {\n        for (var cprop in this) {\n          if (\n            this.hasOwnProperty(cprop) &&\n            !isFunction(this[cprop])\n          ) {\n            watch(this, cprop, this.__o_.__p_, root)\n          }\n        }\n        //todo\n        onPropertyChanged(\n          'Array-' + item,\n          this,\n          old,\n          this,\n          this.__o_.__p_,\n          root\n        )\n      }\n      return result\n    }\n    target[\n      'pure' + item.substring(0, 1).toUpperCase() + item.substring(1)\n    ] = function () {\n      return Array.prototype[item].apply(\n        this,\n        Array.prototype.slice.call(arguments)\n      )\n    }\n  })\n}\n\nfunction watch(target, prop, path, root) {\n  if (prop === '__o_') return\n  if (isFunction(target[prop])) return\n  if (!target.__o_) target.__o_ = {\n    __r_: root\n  }\n  if (path !== undefined && path !== null) {\n    target.__o_.__p_ = path\n  } else {\n    target.__o_.__p_ = '#'\n  }\n\n  var currentValue = (target.__o_[prop] = target[prop])\n  Object.defineProperty(target, prop, {\n    get: function () {\n      return this.__o_[prop]\n    },\n    set: function (value) {\n      var old = this.__o_[prop]\n      this.__o_[prop] = value\n      onPropertyChanged(\n        prop,\n        value,\n        old,\n        this,\n        target.__o_.__p_,\n        root\n      )\n    },\n    configurable: true,\n    enumerable: true\n  })\n  if (typeof currentValue == 'object') {\n    if (isArray(currentValue)) {\n      mock(currentValue, root)\n      if (currentValue.length === 0) {\n        track(currentValue, prop, path)\n      }\n    }\n    if (currentValue && Object.keys(currentValue).length === 0) {\n      track(currentValue, prop, path)\n    }\n    for (var cprop in currentValue) {\n      if (currentValue.hasOwnProperty(cprop)) {\n        watch(\n          currentValue,\n          cprop,\n          target.__o_.__p_ + '-' + prop,\n          root\n        )\n      }\n    }\n  }\n}\n\nfunction track(obj, prop, path) {\n  if (obj.__o_) {\n    return\n  }\n  obj.__o_ = {}\n  if (path !== undefined && path !== null) {\n    obj.__o_.__p_ = path + '-' + prop\n  } else {\n    if (prop !== undefined && prop !== null) {\n      obj.__o_.__p_ = '#' + '-' + prop\n    } else {\n      obj.__o_.__p_ = '#'\n    }\n  }\n}\n\n\nfunction onPropertyChanged(prop, value, oldValue, target, path, root) {\n  if (value !== oldValue && (!(nan(value) && nan(oldValue))) && root.__c_) {\n    var rootName = getRootName(prop, path)\n    for (\n      var i = 0, len = root.__c_.length;\n      i < len;\n      i++\n    ) {\n      var handler = root.__c_[i]\n      if (\n        handler.all ||\n        isInArray(handler.eventPropArr, rootName) ||\n        rootName.indexOf('Array-') === 0\n      ) {\n        handler.propChanged.call(target, prop, value, oldValue, path)\n      }\n    }\n  }\n\n  if (prop.indexOf('Array-') !== 0 && typeof value === 'object') {\n    watch(target, prop, target.__o_.__p_, root)\n  }\n}\n\nfunction isFunction(obj) {\n  return Object.prototype.toString.call(obj) == '[object Function]'\n}\n\nfunction nan(value) {\n  return typeof value === \"number\" && isNaN(value)\n}\n\nfunction isArray(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]'\n}\n\nfunction isString(obj) {\n  return typeof obj === 'string'\n}\n\nfunction isInArray(arr, item) {\n  for (var i = arr.length; --i > -1;) {\n    if (item === arr[i]) return true\n  }\n  return false\n}\n\n\nfunction getRootName(prop, path) {\n  if (path === '#') {\n    return prop\n  }\n  return path.split('-')[1]\n}\n\nobaa.add = function (obj, prop) {\n  watch(obj, prop, obj.__o_.__p_, obj.__o_.__r_)\n}\n\nobaa.set = function (obj, prop, value) {\n  if (obj[prop] === undefined) {\n    watch(obj, prop, obj.__o_.__p_, obj.__o_.__r_)\n  }\n  obj[prop] = value\n}\n\nArray.prototype.size = function (length) {\n  this.length = length\n}\n\n\nexport default obaa\n","﻿import Matrix2D from './matrix2d'\nimport obaa from './obaa'\n\nvar svgNS = \"http://www.w3.org/2000/svg\"\nvar xlink = \"http://www.w3.org/1999/xlink\"\nvar $ = function (el, attr) {\n  if (attr) {\n    if (typeof el == \"string\") {\n      el = $(el)\n    }\n    for (var key in attr) if (attr.hasOwnProperty(key)) {\n      if (key.substring(0, 6) == \"xlink:\") {\n        el.setAttributeNS(xlink, key.substring(6), String(attr[key]))\n      } else {\n        el.setAttribute(key, String(attr[key]))\n      }\n    }\n  } else {\n    el = document.createElementNS(\"http://www.w3.org/2000/svg\", el)\n    el.style && (el.style.webkitTapHighlightColor = \"rgba(0,0,0,0)\")\n    el.opacity = el.scaleX = el.scaleY = 1\n    el.left = el.top = el.rotation = el.skewX = el.skewY = el.originX = el.originY = 0\n    el.matrix = Matrix2D.identity\n    obaa(el, [\"left\", \"top\", \"scaleX\", \"scaleY\", \"rotation\", \"skewX\", \"skewY\", \"originX\", \"originY\"], function () {\n\n      this.matrix.identity().appendTransform(this.left, this.top, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.originX, this.originY)\n\n      $(el, { \"transform\": \"matrix(\" + this.matrix.a + \",\" + this.matrix.b + \",\" + this.matrix.c + \",\" + this.matrix.d + \",\" + this.matrix.tx + \",\" + this.matrix.ty + \")\" })\n    })\n\n    obaa(el, [\"opacity\"], function () {\n      el.setAttribute(\"opacity\", this.opacity)\n    })\n\n    el.attr = function (attr, value) {\n      if (arguments.length === 1) {\n        if (typeof attr === \"string\") {\n          if (attr.indexOf(\":\") !== -1) {\n            return this.getAttributeNS(svgNS, attr)\n          } else {\n            return this.getAttribute(attr)\n          }\n        } else {\n          return $(this, attr)\n        }\n      } else {\n        var obj = {}\n        obj[attr] = value\n        return $(this, obj)\n      }\n\n    }\n  }\n\n  return el\n}\n\nvar _Sving = function (selector, width, height) {\n  this.parent = typeof selector === \"string\" ? document.querySelector(selector) : selector\n  this.svg = document.createElementNS(svgNS, \"svg\")\n  //debug  'style', 'border: 1px solid black\n  this.svg.setAttribute('style', 'border: 1px solid blackoverflow: hidden')\n\n  this.svg.setAttribute('width', width)\n  this.svg.setAttribute('height', height)\n  this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n  this.parent.appendChild(this.svg)\n\n}\n\n_Sving.prototype = {\n  line: function (x1, y1, x2, y2, color) {\n    var line = $(\"line\", { x1: x1, y1: y1, x2: x2, y2: y2 })\n    this.svg.appendChild(line)\n\n    return line\n  },\n  rect: function (width, height) {\n    var rect = $(\"rect\", { width: width, height: height })\n    this.svg.appendChild(rect)\n\n    return rect\n  },\n  text: function (str, font) {\n    var text = $(\"text\")\n    text.style.font = font\n    text.textContent = str\n    this.svg.appendChild(text)\n    return text\n  },\n  circle: function (r) {\n    var circle = $(\"circle\", { r: r })\n    this.svg.appendChild(circle)\n    return circle\n  },\n  //   image   group\n  path: function (d) {\n\n    var path = $(\"path\", { d: d })\n    path.to = _Sving.pathTo\n    this.svg.appendChild(path)\n    return path\n  },\n  ellipse: function (rx, ry) {\n\n    var ellipse = $(\"ellipse\", { rx: rx, ry: ry })\n    this.svg.appendChild(ellipse)\n    return ellipse\n  },\n  image: function (imgOrSrc) {\n    if (typeof imgOrSrc === \"string\") {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc })\n      var tempImage = new Image()\n      tempImage.onload = function () {\n        image.attr({ width: tempImage.width, height: tempImage.height })\n        tempImage = null\n      }\n      tempImage.src = imgOrSrc\n    } else {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc, width: imgOrSrc.width, height: imgOrSrc.height })\n\n    }\n    this.svg.appendChild(image)\n    return image\n\n\n  },\n  group: function () {\n    var group = $(\"g\")\n    this.svg.appendChild(group)\n    var i = 0, len = arguments.length\n    for (; i < len; i++) {\n      group.appendChild(arguments[i])\n    }\n    group.add = function (child) {\n      group.appendChild(child)\n    }\n    group.remove = function (child) {\n      group.removeChild(child)\n    }\n    return group\n  },\n  remove: function (child) {\n    this.svg.removeChild(child)\n  }\n}\n\nvar Sving = function (selector, width, height) {\n\n  return new _Sving(selector, width, height)\n}\n\nwindow.Sving = Sving\n\nexport default Sving\n"],"names":["Matrix2D","a","b","c","d","tx","ty","setValues","DEG_TO_RAD","Math","PI","identity","prototype","a1","b1","c1","d1","x","y","scaleX","scaleY","rotation","skewX","skewY","regX","regY","r","cos","sin","append","matrix","obaa","target","arr","callback","eventPropArr","isArray","length","__o_","Object","keys","__r_","prop","hasOwnProperty","isInArray","push","isString","__c_","propChanged","triggerStr","join","methods","mock","root","forEach","item","old","Array","slice","call","result","apply","arguments","RegExp","test","cprop","isFunction","__p_","substring","toUpperCase","watch","path","undefined","currentValue","defineProperty","value","track","obj","onPropertyChanged","oldValue","nan","rootName","getRootName","i","len","handler","all","indexOf","toString","isNaN","split","add","set","size","svgNS","xlink","$","el","attr","key","setAttributeNS","String","setAttribute","document","createElementNS","style","webkitTapHighlightColor","opacity","left","top","originX","originY","appendTransform","getAttributeNS","getAttribute","_Sving","selector","width","height","parent","querySelector","svg","appendChild","x1","y1","x2","y2","color","line","rect","str","font","text","textContent","circle","to","pathTo","rx","ry","ellipse","imgOrSrc","image","tempImage","Image","onload","src","group","child","remove","removeChild","Sving","window"],"mappings":"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"}