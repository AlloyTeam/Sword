{"version":3,"file":"sving.esm.js","sources":["../src/matrix2d.js","../src/observe.js","../src/sving.js"],"sourcesContent":["﻿\nfunction Matrix2D(a, b, c, d, tx, ty) {\n  this.setValues(a, b, c, d, tx, ty)\n}\n\nMatrix2D.DEG_TO_RAD = Math.PI / 180\n\n\nMatrix2D.identity = null // set at bottom of class definition.\nMatrix2D.prototype = {\n  setValues: function (a, b, c, d, tx, ty) {\n    // don't forget to update docs in the constructor if these change:\n    this.a = (a == null) ? 1 : a\n    this.b = b || 0\n    this.c = c || 0\n    this.d = (d == null) ? 1 : d\n    this.tx = tx || 0\n    this.ty = ty || 0\n    return this\n  },\n\n  append: function (a, b, c, d, tx, ty) {\n    var a1 = this.a\n    var b1 = this.b\n    var c1 = this.c\n    var d1 = this.d\n    if (a != 1 || b != 0 || c != 0 || d != 1) {\n      this.a = a1 * a + c1 * b\n      this.b = b1 * a + d1 * b\n      this.c = a1 * c + c1 * d\n      this.d = b1 * c + d1 * d\n    }\n    this.tx = a1 * tx + c1 * ty + this.tx\n    this.ty = b1 * tx + d1 * ty + this.ty\n    return this\n  },\n\n  appendTransform: function (x, y, scaleX, scaleY, rotation, skewX, skewY, regX, regY) {\n    if (rotation % 360) {\n      var r = rotation * Matrix2D.DEG_TO_RAD\n      var cos = Math.cos(r)\n      var sin = Math.sin(r)\n    } else {\n      cos = 1\n      sin = 0\n    }\n\n    if (skewX || skewY) {\n      // TODO: can this be combined into a single append operation?\n      skewX *= Matrix2D.DEG_TO_RAD\n      skewY *= Matrix2D.DEG_TO_RAD\n      this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y)\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0)\n    } else {\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y)\n    }\n\n    if (regX || regY) {\n      this.tx -= regX * this.a + regY * this.c\n      this.ty -= regX * this.b + regY * this.d\n    }\n    return this\n  },\n\n  identity: function () {\n    this.a = this.d = 1\n    this.b = this.c = this.tx = this.ty = 0\n    return this\n  },\n\n  copy: function (matrix) {\n    return this.setValues(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty)\n  },\n\n  clone: function () {\n    return new Matrix2D(this.a, this.b, this.c, this.d, this.tx, this.ty)\n  },\n\n  toString: function () {\n    return \"[Matrix2D (a=\" + this.a + \" b=\" + this.b + \" c=\" + this.c + \" d=\" + this.d + \" tx=\" + this.tx + \" ty=\" + this.ty + \")]\"\n  }\n}\n\n\nMatrix2D.identity = new Matrix2D()\n\n\nexport default Matrix2D\n","﻿/* observejs --- By dnt http://kmdjs.github.io/\n * Github: https://github.com/kmdjs/observejs\n * MIT Licensed.\n */\n\nvar observe = function (target, arr, callback) {\n  var _observe = function (target, arr, callback) {\n    if (!target.$observer) target.$observer = this;\n    var $observer = target.$observer;\n    var eventPropArr = [];\n    if (observe.isArray(target)) {\n      if (target.length === 0) {\n        target.$observeProps = {};\n        target.$observeProps.$observerPath = \"#\";\n      }\n      $observer.mock(target);\n\n    }\n    for (var prop in target) {\n      if (target.hasOwnProperty(prop)) {\n        if (callback) {\n          if (observe.isArray(arr) && observe.isInArray(arr, prop)) {\n            eventPropArr.push(prop);\n            $observer.watch(target, prop);\n          } else if (observe.isString(arr) && prop == arr) {\n            eventPropArr.push(prop);\n            $observer.watch(target, prop);\n          }\n        } else {\n          eventPropArr.push(prop);\n          $observer.watch(target, prop);\n        }\n      }\n    }\n    $observer.target = target;\n    if (!$observer.propertyChangedHandler) $observer.propertyChangedHandler = [];\n    var propChanged = callback ? callback : arr;\n    $observer.propertyChangedHandler.push({ all: !callback, propChanged: propChanged, eventPropArr: eventPropArr });\n  }\n  _observe.prototype = {\n    \"onPropertyChanged\": function (prop, value, oldValue, target, path) {\n      if (value !== oldValue && this.propertyChangedHandler) {\n        var rootName = observe._getRootName(prop, path);\n        for (var i = 0, len = this.propertyChangedHandler.length; i < len; i++) {\n          var handler = this.propertyChangedHandler[i];\n          if (handler.all || observe.isInArray(handler.eventPropArr, rootName) || rootName.indexOf(\"Array-\") === 0) {\n            handler.propChanged.call(this.target, prop, value, oldValue, path);\n          }\n        }\n      }\n      if (prop.indexOf(\"Array-\") !== 0 && typeof value === \"object\") {\n        this.watch(target, prop, target.$observeProps.$observerPath);\n      }\n    },\n    \"mock\": function (target) {\n      var self = this;\n      observe.methods.forEach(function (item) {\n        target[item] = function () {\n          var old = Array.prototype.slice.call(this, 0);\n          var result = Array.prototype[item].apply(this, Array.prototype.slice.call(arguments));\n          if (new RegExp(\"\\\\b\" + item + \"\\\\b\").test(observe.triggerStr)) {\n            for (var cprop in this) {\n              if (this.hasOwnProperty(cprop) && !observe.isFunction(this[cprop])) {\n                self.watch(this, cprop, this.$observeProps.$observerPath);\n              }\n            }\n            //todo\n            self.onPropertyChanged(\"Array-\" + item, this, old, this, this.$observeProps.$observerPath);\n          }\n          return result;\n        };\n      });\n    },\n    \"watch\": function (target, prop, path) {\n      if (prop === \"$observeProps\" || prop === \"$observer\") return;\n      if (observe.isFunction(target[prop])) return;\n      if (!target.$observeProps) target.$observeProps = {};\n      if (path !== undefined) {\n        target.$observeProps.$observerPath = path;\n      } else {\n        target.$observeProps.$observerPath = \"#\";\n      }\n      var self = this;\n      var currentValue = target.$observeProps[prop] = target[prop];\n      Object.defineProperty(target, prop, {\n        get: function () {\n          return this.$observeProps[prop];\n        },\n        set: function (value) {\n          var old = this.$observeProps[prop];\n          this.$observeProps[prop] = value;\n          self.onPropertyChanged(prop, value, old, this, target.$observeProps.$observerPath);\n        }\n      });\n      if (typeof currentValue == \"object\") {\n        if (observe.isArray(currentValue)) {\n          this.mock(currentValue);\n          if (currentValue.length === 0) {\n            if (!currentValue.$observeProps) currentValue.$observeProps = {};\n            if (path !== undefined) {\n              currentValue.$observeProps.$observerPath = path;\n            } else {\n              currentValue.$observeProps.$observerPath = \"#\";\n            }\n          }\n        }\n        for (var cprop in currentValue) {\n          if (currentValue.hasOwnProperty(cprop)) {\n            this.watch(currentValue, cprop, target.$observeProps.$observerPath + \"-\" + prop);\n          }\n        }\n      }\n    }\n  }\n  return new _observe(target, arr, callback)\n}\nobserve.methods = [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"pop\", \"push\", \"reduce\", \"reduceRight\", \"reverse\", \"shift\", \"slice\", \"some\", \"sort\", \"splice\", \"unshift\", \"toLocaleString\", \"toString\", \"size\"]\nobserve.triggerStr = [\"concat\", \"pop\", \"push\", \"reverse\", \"shift\", \"sort\", \"splice\", \"unshift\", \"size\"].join(\",\")\nobserve.isArray = function (obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n}\nobserve.isString = function (obj) {\n  return typeof obj === \"string\";\n}\nobserve.isInArray = function (arr, item) {\n  for (var i = arr.length; --i > -1;) {\n    if (item === arr[i]) return true;\n  }\n  return false;\n}\nobserve.isFunction = function (obj) {\n  return Object.prototype.toString.call(obj) == '[object Function]';\n}\nobserve.twoWay = function (objA, aProp, objB, bProp) {\n  if (typeof objA[aProp] === \"object\" && typeof objB[bProp] === \"object\") {\n    observe(objA, aProp, function (name, value) {\n      objB[bProp] = this[aProp];\n    })\n    observe(objB, bProp, function (name, value) {\n      objA[aProp] = this[bProp];\n    })\n  } else {\n    observe(objA, aProp, function (name, value) {\n      objB[bProp] = value;\n    })\n    observe(objB, bProp, function (name, value) {\n      objA[aProp] = value;\n    })\n  }\n}\nobserve._getRootName = function (prop, path) {\n  if (path === \"#\") {\n    return prop;\n  }\n  return path.split(\"-\")[1];\n}\n\nobserve.add = function (obj, prop, value) {\n  obj[prop] = value;\n  var $observer = obj.$observer;\n  $observer.watch(obj, prop);\n}\nArray.prototype.size = function (length) {\n  this.length = length;\n}\n\n\nexport default observe\n","﻿import Matrix2D from './matrix2d'\nimport observe from './observe'\n\nvar svgNS = \"http://www.w3.org/2000/svg\"\nvar xlink = \"http://www.w3.org/1999/xlink\"\nvar $ = function (el, attr) {\n  if (attr) {\n    if (typeof el == \"string\") {\n      el = $(el)\n    }\n    for (var key in attr) if (attr.hasOwnProperty(key)) {\n      if (key.substring(0, 6) == \"xlink:\") {\n        el.setAttributeNS(xlink, key.substring(6), String(attr[key]))\n      } else {\n        el.setAttribute(key, String(attr[key]))\n      }\n    }\n  } else {\n    el = document.createElementNS(\"http://www.w3.org/2000/svg\", el)\n    el.style && (el.style.webkitTapHighlightColor = \"rgba(0,0,0,0)\")\n    el.opacity = el.scaleX = el.scaleY = 1\n    el.left = el.top = el.rotation = el.skewX = el.skewY = el.originX = el.originY = 0\n    el.matrix = Matrix2D.identity\n    observe(el, [\"left\", \"top\", \"scaleX\", \"scaleY\", \"rotation\", \"skewX\", \"skewY\", \"originX\", \"originY\"], function () {\n\n      this.matrix.identity().appendTransform(this.left, this.top, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.originX, this.originY)\n\n      $(el, { \"transform\": \"matrix(\" + this.matrix.a + \",\" + this.matrix.b + \",\" + this.matrix.c + \",\" + this.matrix.d + \",\" + this.matrix.tx + \",\" + this.matrix.ty + \")\" })\n    })\n\n    observe(el, [\"opacity\"], function () {\n      el.setAttribute(\"opacity\", this.opacity)\n    })\n\n    el.attr = function (attr, value) {\n      if (arguments.length === 1) {\n        if (typeof attr === \"string\") {\n          if (attr.indexOf(\":\") !== -1) {\n            return this.getAttributeNS(svgNS, attr)\n          } else {\n            return this.getAttribute(attr)\n          }\n        } else {\n          return $(this, attr)\n        }\n      } else {\n        var obj = {}\n        obj[attr] = value\n        return $(this, obj)\n      }\n\n    }\n  }\n\n  return el\n}\n\nvar _Sving = function (selector, width, height) {\n  this.parent = typeof selector === \"string\" ? document.querySelector(selector) : selector\n  this.svg = document.createElementNS(svgNS, \"svg\")\n  //debug  'style', 'border: 1px solid black\n  this.svg.setAttribute('style', 'border: 1px solid blackoverflow: hidden')\n\n  this.svg.setAttribute('width', width)\n  this.svg.setAttribute('height', height)\n  this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n  this.parent.appendChild(this.svg)\n\n}\n\n_Sving.prototype = {\n  line: function (x1, y1, x2, y2, color) {\n    var line = $(\"line\", { x1: x1, y1: y1, x2: x2, y2: y2 })\n    this.svg.appendChild(line)\n\n    return line\n  },\n  rect: function (width, height) {\n    var rect = $(\"rect\", { width: width, height: height })\n    this.svg.appendChild(rect)\n\n    return rect\n  },\n  text: function (str, font) {\n    var text = $(\"text\")\n    text.style.font = font\n    text.textContent = str\n    this.svg.appendChild(text)\n    return text\n  },\n  circle: function (r) {\n    var circle = $(\"circle\", { r: r })\n    this.svg.appendChild(circle)\n    return circle\n  },\n  //   image   group\n  path: function (d) {\n\n    var path = $(\"path\", { d: d })\n    path.to = _Sving.pathTo\n    this.svg.appendChild(path)\n    return path\n  },\n  ellipse: function (rx, ry) {\n\n    var ellipse = $(\"ellipse\", { rx: rx, ry: ry })\n    this.svg.appendChild(ellipse)\n    return ellipse\n  },\n  image: function (imgOrSrc) {\n    if (typeof imgOrSrc === \"string\") {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc })\n      var tempImage = new Image()\n      tempImage.onload = function () {\n        image.attr({ width: tempImage.width, height: tempImage.height })\n        tempImage = null\n      }\n      tempImage.src = imgOrSrc\n    } else {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc, width: imgOrSrc.width, height: imgOrSrc.height })\n\n    }\n    this.svg.appendChild(image)\n    return image\n\n\n  },\n  group: function () {\n    var group = $(\"g\")\n    this.svg.appendChild(group)\n    var i = 0, len = arguments.length\n    for (; i < len; i++) {\n      group.appendChild(arguments[i])\n    }\n    group.add = function (child) {\n      group.appendChild(child)\n    }\n    group.remove = function (child) {\n      group.removeChild(child)\n    }\n    return group\n  },\n  remove: function (child) {\n    this.svg.removeChild(child)\n  }\n}\n\nvar Sving = function (selector, width, height) {\n\n  return new _Sving(selector, width, height)\n}\n\nwindow.Sving = Sving\n\nexport default Sving\n"],"names":["Matrix2D","a","b","c","d","tx","ty","setValues","DEG_TO_RAD","Math","PI","identity","prototype","a1","b1","c1","d1","x","y","scaleX","scaleY","rotation","skewX","skewY","regX","regY","r","cos","sin","append","matrix","observe","target","arr","callback","_observe","$observer","eventPropArr","isArray","length","$observeProps","$observerPath","mock","prop","hasOwnProperty","isInArray","push","watch","isString","propertyChangedHandler","propChanged","all","value","oldValue","path","rootName","_getRootName","i","len","handler","indexOf","call","self","methods","forEach","item","old","Array","slice","result","apply","arguments","RegExp","test","triggerStr","cprop","isFunction","onPropertyChanged","undefined","currentValue","defineProperty","join","obj","Object","toString","twoWay","objA","aProp","objB","bProp","name","split","add","size","svgNS","xlink","$","el","attr","key","substring","setAttributeNS","String","setAttribute","document","createElementNS","style","webkitTapHighlightColor","opacity","left","top","originX","originY","appendTransform","getAttributeNS","getAttribute","_Sving","selector","width","height","parent","querySelector","svg","appendChild","x1","y1","x2","y2","color","line","rect","str","font","text","textContent","circle","to","pathTo","rx","ry","ellipse","imgOrSrc","image","tempImage","Image","onload","src","group","child","remove","removeChild","Sving","window"],"mappings":"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"}