{"version":3,"sources":["../src/matrix2d.js","../src/observe.js","../src/sving.js"],"names":["Matrix2D","a","b","c","d","tx","ty","this","setValues","DEG_TO_RAD","Math","PI","identity","prototype","append","a1","b1","c1","d1","appendTransform","x","y","scaleX","scaleY","rotation","skewX","skewY","regX","regY","r","cos","sin","copy","matrix","clone","toString","observe","target","arr","callback","_observe","$observer","eventPropArr","isArray","length","$observeProps","$observerPath","mock","prop","hasOwnProperty","isInArray","push","watch","isString","propertyChangedHandler","propChanged","all","onPropertyChanged","value","oldValue","path","rootName","_getRootName","i","len","handler","indexOf","call","self","methods","forEach","item","old","Array","slice","result","apply","arguments","RegExp","test","triggerStr","cprop","isFunction","undefined","currentValue","Object","defineProperty","get","set","join","obj","twoWay","objA","aProp","objB","bProp","name","split","add","size","svgNS","$","el","attr","key","substring","setAttributeNS","String","setAttribute","document","createElementNS","style","webkitTapHighlightColor","opacity","left","top","originX","originY","transform","getAttributeNS","getAttribute","_Sving","selector","width","height","parent","querySelector","svg","appendChild","line","x1","y1","x2","y2","color","rect","text","str","font","textContent","circle","to","pathTo","ellipse","rx","ry","image","imgOrSrc","xlink:href","tempImage","Image","onload","src","group","child","remove","removeChild","Sving","window","module","exports","sving"],"mappings":"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","file":"sving.js","sourcesContent":["﻿\nfunction Matrix2D(a, b, c, d, tx, ty) {\n  this.setValues(a, b, c, d, tx, ty)\n}\n\nMatrix2D.DEG_TO_RAD = Math.PI / 180\n\n\nMatrix2D.identity = null // set at bottom of class definition.\nMatrix2D.prototype = {\n  setValues: function (a, b, c, d, tx, ty) {\n    // don't forget to update docs in the constructor if these change:\n    this.a = (a == null) ? 1 : a\n    this.b = b || 0\n    this.c = c || 0\n    this.d = (d == null) ? 1 : d\n    this.tx = tx || 0\n    this.ty = ty || 0\n    return this\n  },\n\n  append: function (a, b, c, d, tx, ty) {\n    var a1 = this.a\n    var b1 = this.b\n    var c1 = this.c\n    var d1 = this.d\n    if (a != 1 || b != 0 || c != 0 || d != 1) {\n      this.a = a1 * a + c1 * b\n      this.b = b1 * a + d1 * b\n      this.c = a1 * c + c1 * d\n      this.d = b1 * c + d1 * d\n    }\n    this.tx = a1 * tx + c1 * ty + this.tx\n    this.ty = b1 * tx + d1 * ty + this.ty\n    return this\n  },\n\n  appendTransform: function (x, y, scaleX, scaleY, rotation, skewX, skewY, regX, regY) {\n    if (rotation % 360) {\n      var r = rotation * Matrix2D.DEG_TO_RAD\n      var cos = Math.cos(r)\n      var sin = Math.sin(r)\n    } else {\n      cos = 1\n      sin = 0\n    }\n\n    if (skewX || skewY) {\n      // TODO: can this be combined into a single append operation?\n      skewX *= Matrix2D.DEG_TO_RAD\n      skewY *= Matrix2D.DEG_TO_RAD\n      this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y)\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0)\n    } else {\n      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y)\n    }\n\n    if (regX || regY) {\n      this.tx -= regX * this.a + regY * this.c\n      this.ty -= regX * this.b + regY * this.d\n    }\n    return this\n  },\n\n  identity: function () {\n    this.a = this.d = 1\n    this.b = this.c = this.tx = this.ty = 0\n    return this\n  },\n\n  copy: function (matrix) {\n    return this.setValues(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty)\n  },\n\n  clone: function () {\n    return new Matrix2D(this.a, this.b, this.c, this.d, this.tx, this.ty)\n  },\n\n  toString: function () {\n    return \"[Matrix2D (a=\" + this.a + \" b=\" + this.b + \" c=\" + this.c + \" d=\" + this.d + \" tx=\" + this.tx + \" ty=\" + this.ty + \")]\"\n  }\n}\n\n\nMatrix2D.identity = new Matrix2D()\n\n\nexport default Matrix2D\n","﻿/* observejs --- By dnt http://kmdjs.github.io/\n * Github: https://github.com/kmdjs/observejs\n * MIT Licensed.\n */\n\nvar observe = function (target, arr, callback) {\n  var _observe = function (target, arr, callback) {\n    if (!target.$observer) target.$observer = this;\n    var $observer = target.$observer;\n    var eventPropArr = [];\n    if (observe.isArray(target)) {\n      if (target.length === 0) {\n        target.$observeProps = {};\n        target.$observeProps.$observerPath = \"#\";\n      }\n      $observer.mock(target);\n\n    }\n    for (var prop in target) {\n      if (target.hasOwnProperty(prop)) {\n        if (callback) {\n          if (observe.isArray(arr) && observe.isInArray(arr, prop)) {\n            eventPropArr.push(prop);\n            $observer.watch(target, prop);\n          } else if (observe.isString(arr) && prop == arr) {\n            eventPropArr.push(prop);\n            $observer.watch(target, prop);\n          }\n        } else {\n          eventPropArr.push(prop);\n          $observer.watch(target, prop);\n        }\n      }\n    }\n    $observer.target = target;\n    if (!$observer.propertyChangedHandler) $observer.propertyChangedHandler = [];\n    var propChanged = callback ? callback : arr;\n    $observer.propertyChangedHandler.push({ all: !callback, propChanged: propChanged, eventPropArr: eventPropArr });\n  }\n  _observe.prototype = {\n    \"onPropertyChanged\": function (prop, value, oldValue, target, path) {\n      if (value !== oldValue && this.propertyChangedHandler) {\n        var rootName = observe._getRootName(prop, path);\n        for (var i = 0, len = this.propertyChangedHandler.length; i < len; i++) {\n          var handler = this.propertyChangedHandler[i];\n          if (handler.all || observe.isInArray(handler.eventPropArr, rootName) || rootName.indexOf(\"Array-\") === 0) {\n            handler.propChanged.call(this.target, prop, value, oldValue, path);\n          }\n        }\n      }\n      if (prop.indexOf(\"Array-\") !== 0 && typeof value === \"object\") {\n        this.watch(target, prop, target.$observeProps.$observerPath);\n      }\n    },\n    \"mock\": function (target) {\n      var self = this;\n      observe.methods.forEach(function (item) {\n        target[item] = function () {\n          var old = Array.prototype.slice.call(this, 0);\n          var result = Array.prototype[item].apply(this, Array.prototype.slice.call(arguments));\n          if (new RegExp(\"\\\\b\" + item + \"\\\\b\").test(observe.triggerStr)) {\n            for (var cprop in this) {\n              if (this.hasOwnProperty(cprop) && !observe.isFunction(this[cprop])) {\n                self.watch(this, cprop, this.$observeProps.$observerPath);\n              }\n            }\n            //todo\n            self.onPropertyChanged(\"Array-\" + item, this, old, this, this.$observeProps.$observerPath);\n          }\n          return result;\n        };\n      });\n    },\n    \"watch\": function (target, prop, path) {\n      if (prop === \"$observeProps\" || prop === \"$observer\") return;\n      if (observe.isFunction(target[prop])) return;\n      if (!target.$observeProps) target.$observeProps = {};\n      if (path !== undefined) {\n        target.$observeProps.$observerPath = path;\n      } else {\n        target.$observeProps.$observerPath = \"#\";\n      }\n      var self = this;\n      var currentValue = target.$observeProps[prop] = target[prop];\n      Object.defineProperty(target, prop, {\n        get: function () {\n          return this.$observeProps[prop];\n        },\n        set: function (value) {\n          var old = this.$observeProps[prop];\n          this.$observeProps[prop] = value;\n          self.onPropertyChanged(prop, value, old, this, target.$observeProps.$observerPath);\n        }\n      });\n      if (typeof currentValue == \"object\") {\n        if (observe.isArray(currentValue)) {\n          this.mock(currentValue);\n          if (currentValue.length === 0) {\n            if (!currentValue.$observeProps) currentValue.$observeProps = {};\n            if (path !== undefined) {\n              currentValue.$observeProps.$observerPath = path;\n            } else {\n              currentValue.$observeProps.$observerPath = \"#\";\n            }\n          }\n        }\n        for (var cprop in currentValue) {\n          if (currentValue.hasOwnProperty(cprop)) {\n            this.watch(currentValue, cprop, target.$observeProps.$observerPath + \"-\" + prop);\n          }\n        }\n      }\n    }\n  }\n  return new _observe(target, arr, callback)\n}\nobserve.methods = [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"pop\", \"push\", \"reduce\", \"reduceRight\", \"reverse\", \"shift\", \"slice\", \"some\", \"sort\", \"splice\", \"unshift\", \"toLocaleString\", \"toString\", \"size\"]\nobserve.triggerStr = [\"concat\", \"pop\", \"push\", \"reverse\", \"shift\", \"sort\", \"splice\", \"unshift\", \"size\"].join(\",\")\nobserve.isArray = function (obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n}\nobserve.isString = function (obj) {\n  return typeof obj === \"string\";\n}\nobserve.isInArray = function (arr, item) {\n  for (var i = arr.length; --i > -1;) {\n    if (item === arr[i]) return true;\n  }\n  return false;\n}\nobserve.isFunction = function (obj) {\n  return Object.prototype.toString.call(obj) == '[object Function]';\n}\nobserve.twoWay = function (objA, aProp, objB, bProp) {\n  if (typeof objA[aProp] === \"object\" && typeof objB[bProp] === \"object\") {\n    observe(objA, aProp, function (name, value) {\n      objB[bProp] = this[aProp];\n    })\n    observe(objB, bProp, function (name, value) {\n      objA[aProp] = this[bProp];\n    })\n  } else {\n    observe(objA, aProp, function (name, value) {\n      objB[bProp] = value;\n    })\n    observe(objB, bProp, function (name, value) {\n      objA[aProp] = value;\n    })\n  }\n}\nobserve._getRootName = function (prop, path) {\n  if (path === \"#\") {\n    return prop;\n  }\n  return path.split(\"-\")[1];\n}\n\nobserve.add = function (obj, prop, value) {\n  obj[prop] = value;\n  var $observer = obj.$observer;\n  $observer.watch(obj, prop);\n}\nArray.prototype.size = function (length) {\n  this.length = length;\n}\n\n\nexport default observe\n","﻿import Matrix2D from './matrix2d'\nimport observe from './observe'\n\nvar svgNS = \"http://www.w3.org/2000/svg\"\nvar xlink = \"http://www.w3.org/1999/xlink\"\nvar $ = function (el, attr) {\n  if (attr) {\n    if (typeof el == \"string\") {\n      el = $(el)\n    }\n    for (var key in attr) if (attr.hasOwnProperty(key)) {\n      if (key.substring(0, 6) == \"xlink:\") {\n        el.setAttributeNS(xlink, key.substring(6), String(attr[key]))\n      } else {\n        el.setAttribute(key, String(attr[key]))\n      }\n    }\n  } else {\n    el = document.createElementNS(\"http://www.w3.org/2000/svg\", el)\n    el.style && (el.style.webkitTapHighlightColor = \"rgba(0,0,0,0)\")\n    el.opacity = el.scaleX = el.scaleY = 1\n    el.left = el.top = el.rotation = el.skewX = el.skewY = el.originX = el.originY = 0\n    el.matrix = Matrix2D.identity\n    observe(el, [\"left\", \"top\", \"scaleX\", \"scaleY\", \"rotation\", \"skewX\", \"skewY\", \"originX\", \"originY\"], function () {\n\n      this.matrix.identity().appendTransform(this.left, this.top, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.originX, this.originY)\n\n      $(el, { \"transform\": \"matrix(\" + this.matrix.a + \",\" + this.matrix.b + \",\" + this.matrix.c + \",\" + this.matrix.d + \",\" + this.matrix.tx + \",\" + this.matrix.ty + \")\" })\n    })\n\n    observe(el, [\"opacity\"], function () {\n      el.setAttribute(\"opacity\", this.opacity)\n    })\n\n    el.attr = function (attr, value) {\n      if (arguments.length === 1) {\n        if (typeof attr === \"string\") {\n          if (attr.indexOf(\":\") !== -1) {\n            return this.getAttributeNS(svgNS, attr)\n          } else {\n            return this.getAttribute(attr)\n          }\n        } else {\n          return $(this, attr)\n        }\n      } else {\n        var obj = {}\n        obj[attr] = value\n        return $(this, obj)\n      }\n\n    }\n  }\n\n  return el\n}\n\nvar _Sving = function (selector, width, height) {\n  this.parent = typeof selector === \"string\" ? document.querySelector(selector) : selector\n  this.svg = document.createElementNS(svgNS, \"svg\")\n  //debug  'style', 'border: 1px solid black\n  this.svg.setAttribute('style', 'border: 1px solid blackoverflow: hidden')\n\n  this.svg.setAttribute('width', width)\n  this.svg.setAttribute('height', height)\n  this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n  this.parent.appendChild(this.svg)\n\n}\n\n_Sving.prototype = {\n  line: function (x1, y1, x2, y2, color) {\n    var line = $(\"line\", { x1: x1, y1: y1, x2: x2, y2: y2 })\n    this.svg.appendChild(line)\n\n    return line\n  },\n  rect: function (width, height) {\n    var rect = $(\"rect\", { width: width, height: height })\n    this.svg.appendChild(rect)\n\n    return rect\n  },\n  text: function (str, font) {\n    var text = $(\"text\")\n    text.style.font = font\n    text.textContent = str\n    this.svg.appendChild(text)\n    return text\n  },\n  circle: function (r) {\n    var circle = $(\"circle\", { r: r })\n    this.svg.appendChild(circle)\n    return circle\n  },\n  //   image   group\n  path: function (d) {\n\n    var path = $(\"path\", { d: d })\n    path.to = _Sving.pathTo\n    this.svg.appendChild(path)\n    return path\n  },\n  ellipse: function (rx, ry) {\n\n    var ellipse = $(\"ellipse\", { rx: rx, ry: ry })\n    this.svg.appendChild(ellipse)\n    return ellipse\n  },\n  image: function (imgOrSrc) {\n    if (typeof imgOrSrc === \"string\") {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc })\n      var tempImage = new Image()\n      tempImage.onload = function () {\n        image.attr({ width: tempImage.width, height: tempImage.height })\n        tempImage = null\n      }\n      tempImage.src = imgOrSrc\n    } else {\n      var image = $(\"image\", { \"xlink:href\": imgOrSrc, width: imgOrSrc.width, height: imgOrSrc.height })\n\n    }\n    this.svg.appendChild(image)\n    return image\n\n\n  },\n  group: function () {\n    var group = $(\"g\")\n    this.svg.appendChild(group)\n    var i = 0, len = arguments.length\n    for (; i < len; i++) {\n      group.appendChild(arguments[i])\n    }\n    group.add = function (child) {\n      group.appendChild(child)\n    }\n    group.remove = function (child) {\n      group.removeChild(child)\n    }\n    return group\n  },\n  remove: function (child) {\n    this.svg.removeChild(child)\n  }\n}\n\nvar Sving = function (selector, width, height) {\n\n  return new _Sving(selector, width, height)\n}\n\nwindow.Sving = Sving\n\nexport default Sving\n"]}