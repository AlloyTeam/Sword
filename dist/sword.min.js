/* Sword
 * By AlloyTeam http://www.alloyteam.com/
 * Github: https://github.com/AlloyTeam/Sword
 * MIT Licensed.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():"function"==typeof define&&define.cmd?define(function(t,r,i){i.exports=e()}):t.Sword=e()}(this,function(){function t(t,e,r,i,s,n){this.setValues(t,e,r,i,s,n)}t.DEG_TO_RAD=Math.PI/180,t.identity=null,t.prototype={setValues:function(t,e,r,i,s,n){return this.a=null==t?1:t,this.b=e||0,this.c=r||0,this.d=null==i?1:i,this.tx=s||0,this.ty=n||0,this},append:function(t,e,r,i,s,n){var o=this.a,h=this.b,a=this.c,p=this.d;return(1!=t||0!=e||0!=r||1!=i)&&(this.a=o*t+a*e,this.b=h*t+p*e,this.c=o*r+a*i,this.d=h*r+p*i),this.tx=o*s+a*n+this.tx,this.ty=h*s+p*n+this.ty,this},appendTransform:function(e,r,i,s,n,o,h,a,p){if(n%360)var c=n*t.DEG_TO_RAD,u=Math.cos(c),f=Math.sin(c);else u=1,f=0;return o||h?(o*=t.DEG_TO_RAD,h*=t.DEG_TO_RAD,this.append(Math.cos(h),Math.sin(h),-Math.sin(o),Math.cos(o),e,r),this.append(u*i,f*i,-f*s,u*s,0,0)):this.append(u*i,f*i,-f*s,u*s,e,r),(a||p)&&(this.tx-=a*this.a+p*this.c,this.ty-=a*this.b+p*this.d),this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},copy:function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},clone:function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)},toString:function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"}},t.identity=new t;var e=function(t,r,i){var s=function(t,r,i){t.$observer||(t.$observer=this);var s=t.$observer,n=[];e.isArray(t)&&(0===t.length&&(t.$observeProps={},t.$observeProps.$observerPath="#"),s.mock(t));for(var o in t)t.hasOwnProperty(o)&&(i?e.isArray(r)&&e.isInArray(r,o)?(n.push(o),s.watch(t,o)):e.isString(r)&&o==r&&(n.push(o),s.watch(t,o)):(n.push(o),s.watch(t,o)));s.target=t,s.propertyChangedHandler||(s.propertyChangedHandler=[]);var h=i?i:r;s.propertyChangedHandler.push({all:!i,propChanged:h,eventPropArr:n})};return s.prototype={onPropertyChanged:function(t,r,i,s,n){if(r!==i&&this.propertyChangedHandler)for(var o=e._getRootName(t,n),h=0,a=this.propertyChangedHandler.length;a>h;h++){var p=this.propertyChangedHandler[h];(p.all||e.isInArray(p.eventPropArr,o)||0===o.indexOf("Array-"))&&p.propChanged.call(this.target,t,r,i,n)}0!==t.indexOf("Array-")&&"object"==typeof r&&this.watch(s,t,s.$observeProps.$observerPath)},mock:function(t){var r=this;e.methods.forEach(function(i){t[i]=function(){var t=Array.prototype.slice.call(this,0),s=Array.prototype[i].apply(this,Array.prototype.slice.call(arguments));if(new RegExp("\\b"+i+"\\b").test(e.triggerStr)){for(var n in this)this.hasOwnProperty(n)&&!e.isFunction(this[n])&&r.watch(this,n,this.$observeProps.$observerPath);r.onPropertyChanged("Array-"+i,this,t,this,this.$observeProps.$observerPath)}return s}})},watch:function(t,r,i){if("$observeProps"!==r&&"$observer"!==r&&!e.isFunction(t[r])){t.$observeProps||(t.$observeProps={}),t.$observeProps.$observerPath=void 0!==i?i:"#";var s=this,n=t.$observeProps[r]=t[r];if(Object.defineProperty(t,r,{get:function(){return this.$observeProps[r]},set:function(e){var i=this.$observeProps[r];this.$observeProps[r]=e,s.onPropertyChanged(r,e,i,this,t.$observeProps.$observerPath)}}),"object"==typeof n){e.isArray(n)&&(this.mock(n),0===n.length&&(n.$observeProps||(n.$observeProps={}),n.$observeProps.$observerPath=void 0!==i?i:"#"));for(var o in n)n.hasOwnProperty(o)&&this.watch(n,o,t.$observeProps.$observerPath+"-"+r)}}}},new s(t,r,i)};e.methods=["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","unshift","toLocaleString","toString","size"],e.triggerStr=["concat","pop","push","reverse","shift","sort","splice","unshift","size"].join(","),e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.isString=function(t){return"string"==typeof t},e.isInArray=function(t,e){for(var r=t.length;--r>-1;)if(e===t[r])return!0;return!1},e.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},e.twoWay=function(t,r,i,s){"object"==typeof t[r]&&"object"==typeof i[s]?(e(t,r,function(t,e){i[s]=this[r]}),e(i,s,function(e,i){t[r]=this[s]})):(e(t,r,function(t,e){i[s]=e}),e(i,s,function(e,i){t[r]=i}))},e._getRootName=function(t,e){return"#"===e?t:e.split("-")[1]},e.add=function(t,e,r){t[e]=r;var i=t.$observer;i.watch(t,e)},Array.prototype.size=function(t){this.length=t};var r="http://www.w3.org/2000/svg",i="http://www.w3.org/1999/xlink",s=function(n,o){if(o){"string"==typeof n&&(n=s(n));for(var h in o)o.hasOwnProperty(h)&&("xlink:"==h.substring(0,6)?n.setAttributeNS(i,h.substring(6),String(o[h])):n.setAttribute(h,String(o[h])))}else n=document.createElementNS("http://www.w3.org/2000/svg",n),n.style&&(n.style.webkitTapHighlightColor="rgba(0,0,0,0)"),n.opacity=n.scaleX=n.scaleY=1,n.left=n.top=n.rotation=n.skewX=n.skewY=n.originX=n.originY=0,n.matrix=t.identity,e(n,["left","top","scaleX","scaleY","rotation","skewX","skewY","originX","originY"],function(){this.matrix.identity().appendTransform(this.left,this.top,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY,this.originX,this.originY),s(n,{transform:"matrix("+this.matrix.a+","+this.matrix.b+","+this.matrix.c+","+this.matrix.d+","+this.matrix.tx+","+this.matrix.ty+")"})}),e(n,["opacity"],function(){n.setAttribute("opacity",this.opacity)}),n.attr=function(t,e){if(1===arguments.length)return"string"==typeof t?-1!==t.indexOf(":")?this.getAttributeNS(r,t):this.getAttribute(t):s(this,t);var i={};return i[t]=e,s(this,i)};return n},n=function(t,e,i){this.parent="string"==typeof t?document.querySelector(t):t,this.svg=document.createElementNS(r,"svg"),this.svg.setAttribute("style","border: 1px solid black;overflow: hidden;"),this.svg.setAttribute("width",e),this.svg.setAttribute("height",i),this.svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.parent.appendChild(this.svg)};n.prototype={line:function(t,e,r,i,n){var o=s("line",{x1:t,y1:e,x2:r,y2:i});return this.svg.appendChild(o),o},rect:function(t,e){var r=s("rect",{width:t,height:e});return this.svg.appendChild(r),r},text:function(t,e){var r=s("text");return r.style.font=e,r.textContent=t,this.svg.appendChild(r),r},circle:function(t){var e=s("circle",{r:t});return this.svg.appendChild(e),e},path:function(t){var e=s("path",{d:t});return this.svg.appendChild(e),e},ellipse:function(t,e){var r=s("ellipse",{rx:t,ry:e});return this.svg.appendChild(r),r},image:function(t){if("string"==typeof t){var e=s("image",{"xlink:href":t}),r=new Image;r.onload=function(){e.attr({width:r.width,height:r.height}),r=null},r.src=t}else var e=s("image",{"xlink:href":t,width:t.width,height:t.height});return this.svg.appendChild(e),e},group:function(){var t=s("g");this.svg.appendChild(t);for(var e=0,r=arguments.length;r>e;e++)t.appendChild(arguments[e]);return t.add=function(e){t.appendChild(e)},t.remove=function(e){t.removeChild(e)},t},remove:function(t){this.svg.removeChild(t)}};var o=function(t,e,r){return new n(t,e,r)};return o});